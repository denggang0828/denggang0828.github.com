---
layout: post
title: "正确理解drawRect"
categories: 性能优化
tags: drawRect 性能优化
---
一、案例
之前做过一个应用，其中一个界面为UITableView，每一个UITableViewCell有背景图、缩略图及一些描述性的文字。后来，由于美工设计改变，需要对缩略图加一些遮罩及阴影的效果。因为之前是通过UIView的subviews的方式实现的tableviewCell，所以第一反应是通过layer设置其阴影及边框，虽然知道做这种操作会影响App的性能，特别是对这种滚动视图。果然，加了阴影效果之后，滚动会有明显的卡顿，点击cellItem时感觉反应缓慢。

通过Instruments测试，帧率与60fps比较差距较大，着手考虑优化方案。首先尝试的是设置它的shadowpath，指定它的阴影路径从而减小对阴影形状的计算。改进效果不是很明显。然后尝试使用drawRect，效果改进明显。这个地方就带来一个思考，drawRect为什么高效。
<br />
二、drawRect是否真正高效？
<br />
三、为什么drawRect可以使滚动流畅
<br />
四、其他可以改进的地方
